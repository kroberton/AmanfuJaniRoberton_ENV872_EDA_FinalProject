---
output: 
  pdf_document:
    keep_tex: yes
    fig_caption: yes
    number_sections: yes
geometry: margin=2.54cm
title: "Risk of Coastal Flooding"
subtitle: "Web address for GitHub repository"
author: "Name"
fontsize: 12pt
mainfont: Times New Roman
---
```{r, initialize}
# Set your working directory
getwd()
knitr::opts_knit$set(root.dir = '/xxxDesktop/Duke MPP/Environ Data /872 Final Project/AmanfuJaniRoberton_ENV872_EDA_FinalProject')

```
## Potential research questions!!!

-   Write what you're thinking about!
-   <https://www.thetransportpolitic.com/2022/01/24/openings-and-construction-starts-planned-for-2022/>
-   <https://theintercept.com/2022/02/12/wildfires-prisons-climate-california/>
-   <https://cseveren.github.io/files/racialized_difference_commuting_20220320.pdf> <https://github.com/OpenFloodAI/Climate-Change-Datasets> <https://github.com/firstlookmedia/climate-and-punishment-data> \newpage-

```{=tex}
\newpage
\tableofcontents 
\newpage
\listoftables 
\newpage
\listoffigures 
\newpage
```


```{r setup, include=FALSE}
# Load your packages
library(agricolae)
library(corrplot)
library(cowplot)
library(dataRetrieval)
library(extrafont)
library(extrafontdb)
library(ggpubr)
library(ggthemes)
library(hrbrthemes)
library(Kendall)
library(leaflet)
library(lubridate)
library(mapview)
library(rvest)
library(sf)
library(tidycensus)
library(tidyverse)
library(trend)
library(tseries)
library(viridis)
library(zoo)


# Set your ggplot theme
#Disable on-the-fly projections
sf::sf_use_s2(FALSE)
#Fix Mapview
mapviewOptions(fgb = FALSE)

Theme2 <- theme_ipsum()+
  theme(legend.position = "bottom",
        legend.key = element_rect(fill = "white", colour = "black"),legend.direction = "horizontal",
        legend.title = element_text(face = "bold"))
theme_set(Theme2)
```

# Rationale and Research Questions





# Dataset Information

## Methodology

### Gather Data Sources
```{r load datasources}
# Load your datasets
NRICali <- read.csv('~/Desktop/Duke MPP/Environ Data /872 Final Project/AmanfuJaniRoberton_ENV872_EDA_FinalProject/Data Sources/NRI_Table_CensusTracts_California/NRI_Table_CensusTracts_California.csv', stringsAsFactors = TRUE)
NRINorCar <- read.csv('~/Desktop/Duke MPP/Environ Data /872 Final Project/AmanfuJaniRoberton_ENV872_EDA_FinalProject/Data Sources/NRI_Table_CensusTracts_NorthCarolina/NRI_Table_CensusTracts_NorthCarolina.csv', stringsAsFactors = TRUE)
NRIFlor <- read.csv('~/Desktop/Duke MPP/Environ Data /872 Final Project/AmanfuJaniRoberton_ENV872_EDA_FinalProject/Data Sources/NRI_Table_CensusTracts_Florida/NRI_Table_CensusTracts_Florida.csv', stringsAsFactors = TRUE)
EJScreen21 <- read.csv('~/Desktop/Duke MPP/Environ Data /872 Final Project/AmanfuJaniRoberton_ENV872_EDA_FinalProject/Data Sources/EJSCREEN_2021_StatePctile_Tracts.csv',stringsAsFactors = TRUE)
```

####EJSCREEN Gathered From: 
2020
#### National Risk Index 
Gathered from: <https://hazards.fema.gov/nri/data-resources> North Carolina

### Clean Data Sources

Filter and pipe each to just the variables of interest: location, titles, variables 1 and 2
```{r initial filter}
NRICali2 <- NRICali %>%
  select(OID_,NRI_ID,STATE,COUNTY,TRACTFIPS,POPULATION,
         ends_with("RATNG"),ends_with("RISKS"),ends_with("RISKR"),ends_with("EVENTS"),
         ends_with("SCORE"),ends_with("EALS"),ends_with("EALR")) %>%
         select(!starts_with("LTNG"),!starts_with("AVLN"),!starts_with("HAIL"),
                !starts_with("LNDS"),!starts_with("VLCN"))

NRIFlor2 <- NRIFlor %>%
  select(OID_,NRI_ID,STATE,COUNTY,TRACTFIPS,POPULATION,
         ends_with("RATNG"),ends_with("RISKS"),ends_with("RISKR"),ends_with("EVENTS"),
         ends_with("SCORE"),ends_with("EALS"),ends_with("EALR")) %>%
         select(!starts_with("LTNG"),!starts_with("AVLN"),!starts_with("HAIL"),
                !starts_with("LNDS"),!starts_with("VLCN"))

NRINorCar2 <- NRINorCar %>%
  select(OID_,NRI_ID,STATE,COUNTY,TRACTFIPS,POPULATION,
         ends_with("RATNG"),ends_with("RISKS"),ends_with("RISKR"),ends_with("EVENTS"),
         ends_with("SCORE"),ends_with("EALS"),ends_with("EALR")) %>%
         select(!starts_with("LTNG"),!starts_with("AVLN"),!starts_with("HAIL"),
                !starts_with("LNDS"),!starts_with("VLCN"))

EJScreen21 <- EJScreen21 %>%
  filter(grepl('Florida|California|North Carolina',STATE_NAME))
```


Questions:(NC, FL, CA)
1. 1960 Housing (size of datapoint) v Coastal Flood risk (Color on map)
2. Percent Low Income v  Flood Risk
--3? PM2.5 (size of datapoint) v Wildfire Risk  (color)--
```{r risk filters}
#flood risks 
NRICaliFlood <- NRICali2 %>%
  select(OID_,NRI_ID,STATE,COUNTY,TRACTFIPS,POPULATION,starts_with("CFLD"),starts_with("RFLD"))
NRIFlorFlood <- NRIFlor2 %>%
  select(OID_,NRI_ID,STATE,COUNTY,TRACTFIPS,POPULATION,starts_with("CFLD"),starts_with("RFLD"))
NRINorCarFlood <- NRINorCar2 %>%
  select(OID_,NRI_ID,STATE,COUNTY,TRACTFIPS,POPULATION,starts_with("CFLD"),starts_with("RFLD"))

#fire risks
NRICaliFire <- NRICali2 %>%
  select(OID_,NRI_ID,STATE,COUNTY,TRACTFIPS,POPULATION,starts_with("WFIR"))
NRIFlorFire <- NRIFlor2 %>%
  select(OID_,NRI_ID,STATE,COUNTY,TRACTFIPS,POPULATION,starts_with("WFIR"))
NRINorCarFire <- NRINorCar2 %>%
  select(OID_,NRI_ID,STATE,COUNTY,TRACTFIPS,POPULATION,starts_with("WFIR"))
```

```{r EJScreen Filters}
EJ_filter <- EJScreen21 %>%
  select(ID,STATE_NAME,contains("INCPCT"),contains("HSPCT"),LINGISOPCT,PRE1960PCT,contains("LDPNT"),contains("PM25"))
```

### Present Descriptive Statistics and Maps

```{r}

mydata <- readr::read.csv('~/Desktop/Duke MPP/Environ Data /872 Final Project/AmanfuJaniRoberton_ENV872_EDA_FinalProject/Data Sources/NRI_Table_CensusTracts_NorthCarolina/NRI_Table_CensusTracts_NorthCarolina.csv')

mymap <-st_read('/Desktop/Duke MPP/Environ Data /872 Final Project/AmanfuJaniRoberton_ENV872_EDA_FinalProject/Data Sources/NRI_Table_CensusTracts_NorthCarolina/NRI_Table_CensusTracts_NorthCarolina.csv')

str(mymap)




### Time Series

\newpage

# Exploratory Analysis

\newpage

# Analysis

## Question 1: \<insert specific question here and add additional subsections for additional questions below, if needed>

## Question 2:

\newpage

# Summary and Conclusions

\newpage

# References

\<add references here if relevant, otherwise delete this section>
